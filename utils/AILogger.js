/**
 * AIÁâπÂåñLogger
 *
 * „ÄêË®≠Ë®àÊÄùÊÉ≥„Äë
 * - AI„ÅåÂïèÈ°å„ÇíÁû¨ÊôÇ„Å´ÁâπÂÆö„Åß„Åç„ÇãÊßãÈÄ†Âåñ„É≠„Ç∞
 * - „Éë„Çø„Éº„É≥Ë™çË≠ò„Åó„ÇÑ„Åô„ÅÑ‰∏ÄË≤´„Åó„Åü„Éï„Ç©„Éº„Éû„ÉÉ„Éà
 * - „Ç≥„É≥„ÉÜ„Ç≠„Çπ„ÉàÊÉÖÂ†±„ÅÆÊúÄÂ§ßÂåñ
 * - „Éà„É¨„Éº„ÇπÂèØËÉΩÊÄß„ÅÆÂÆåÂÖ®‰øùË®º
 */
export var LogLevel;
(function (LogLevel) {
    LogLevel[LogLevel["DEBUG"] = 0] = "DEBUG";
    LogLevel[LogLevel["INFO"] = 1] = "INFO";
    LogLevel[LogLevel["WARN"] = 2] = "WARN";
    LogLevel[LogLevel["ERROR"] = 3] = "ERROR";
    LogLevel[LogLevel["FATAL"] = 4] = "FATAL";
})(LogLevel || (LogLevel = {}));
export class AILogger {
    constructor() {
        Object.defineProperty(this, "sessionId", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "sequence", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "logLevel", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: LogLevel.DEBUG
        });
        Object.defineProperty(this, "logBuffer", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        Object.defineProperty(this, "correlationStack", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        this.sessionId = this.generateSessionId();
        this.logSystemInfo();
    }
    static getInstance() {
        if (!AILogger.instance) {
            AILogger.instance = new AILogger();
        }
        return AILogger.instance;
    }
    /**
     * AIÂàÜÊûêÁî®: „Éá„Éê„ÉÉ„Ç∞„É≠„Ç∞ - Ë©≥Á¥∞„Å™ÂÆüË°å„Éà„É¨„Éº„Çπ
     */
    debug(context, message, tags = []) {
        this.log(LogLevel.DEBUG, context, message, tags);
    }
    /**
     * AIÂàÜÊûêÁî®: ÊÉÖÂ†±„É≠„Ç∞ - Ê≠£Â∏∏„Éï„É≠„ÉºËøΩË∑°
     */
    info(context, message, tags = []) {
        this.log(LogLevel.INFO, context, message, tags);
    }
    /**
     * AIÂàÜÊûêÁî®: Ë≠¶Âëä„É≠„Ç∞ - Áï∞Â∏∏Ê§úÁü•
     */
    warn(context, message, tags = []) {
        this.log(LogLevel.WARN, context, message, tags);
    }
    /**
     * AIÂàÜÊûêÁî®: „Ç®„É©„Éº„É≠„Ç∞ - ÈöúÂÆ≥ÂàÜÊûê
     */
    error(context, message, tags = []) {
        this.log(LogLevel.ERROR, context, message, tags);
    }
    /**
     * AIÂàÜÊûêÁî®: Ëá¥ÂëΩÁöÑ„Ç®„É©„Éº - Âç≥Â∫ßÂØæÂøúÂøÖË¶Å
     */
    fatal(context, message, tags = []) {
        this.log(LogLevel.FATAL, context, message, tags);
    }
    /**
     * AIÂàÜÊûêÁî®: Êìç‰ΩúÈñãÂßã - „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπËøΩË∑°ÈñãÂßã
     */
    startOperation(component, method, operation, data) {
        const correlationId = this.generateCorrelationId();
        this.correlationStack.push(correlationId);
        this.info({
            component,
            method,
            operation: `START_${operation}`,
            data
        }, `üöÄ OPERATION_START: ${operation}`, ['operation', 'start', 'performance']);
        return correlationId;
    }
    /**
     * AIÂàÜÊûêÁî®: Êìç‰ΩúÁµÇ‰∫Ü - „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπËøΩË∑°ÁµÇ‰∫Ü
     */
    endOperation(correlationId, success, duration, result) {
        const index = this.correlationStack.indexOf(correlationId);
        if (index > -1) {
            this.correlationStack.splice(index, 1);
        }
        const level = success ? LogLevel.INFO : LogLevel.ERROR;
        const emoji = success ? '‚úÖ' : '‚ùå';
        this.log(level, {
            component: 'OPERATION',
            method: 'endOperation',
            operation: success ? 'SUCCESS' : 'FAILURE',
            duration,
            data: result
        }, `${emoji} OPERATION_END: ${success ? 'SUCCESS' : 'FAILURE'} (${duration}ms)`, ['operation', 'end', 'performance', success ? 'success' : 'failure'], correlationId);
    }
    /**
     * AIÂàÜÊûêÁî®: „Éï„É≠„Éº„Éà„É¨„Éº„Çπ - „Éá„Éº„Çø„Éï„É≠„ÉºËøΩË∑°
     */
    trace(component, method, phase, data) {
        this.debug({
            component,
            method,
            operation: `TRACE_${phase}`,
            data: this.sanitizeData(data)
        }, `üîç TRACE: ${phase}`, ['trace', 'flow', phase.toLowerCase()]);
    }
    /**
     * AIÂàÜÊûêÁî®: Áä∂ÊÖãÂ§âÊõ¥ - „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Áä∂ÊÖãËøΩË∑°
     */
    stateChange(component, from, to, trigger, data) {
        this.info({
            component,
            method: 'stateChange',
            operation: 'STATE_TRANSITION',
            data: { from, to, trigger, ...data }
        }, `üîÑ STATE_CHANGE: ${from} ‚Üí ${to} (${trigger})`, ['state', 'transition', from, to]);
    }
    /**
     * AIÂàÜÊûêÁî®: APIÂëº„Å≥Âá∫„Åó - Â§ñÈÉ®‰æùÂ≠òÊÄßËøΩË∑°
     */
    apiCall(url, method, duration, status, error) {
        const isSuccess = status && status >= 200 && status < 300;
        const level = error ? LogLevel.ERROR : (isSuccess ? LogLevel.INFO : LogLevel.WARN);
        const emoji = error ? '‚ùå' : (isSuccess ? '‚úÖ' : '‚ö†Ô∏è');
        this.log(level, {
            component: 'API',
            method: 'fetch',
            operation: method,
            url,
            duration,
            data: { status, method },
            error
        }, `${emoji} API_CALL: ${method} ${url} [${status || 'UNKNOWN'}] (${duration || 0}ms)`, ['api', 'network', method.toLowerCase(), isSuccess ? 'success' : 'failure']);
    }
    /**
     * AIÂàÜÊûêÁî®: „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊ∏¨ÂÆö
     */
    performance(component, operation, duration, metadata) {
        const level = duration > 1000 ? LogLevel.WARN : LogLevel.INFO;
        const emoji = duration > 1000 ? 'üêå' : '‚ö°';
        this.log(level, {
            component,
            method: 'performance',
            operation,
            duration,
            data: metadata
        }, `${emoji} PERFORMANCE: ${operation} took ${duration}ms`, ['performance', 'timing']);
    }
    /**
     * AIÂàÜÊûêÁî®: „É¶„Éº„Ç∂„Éº„Ç¢„ÇØ„Ç∑„Éß„É≥ËøΩË∑°
     */
    userAction(action, element, data) {
        this.info({
            component: 'USER',
            method: 'interaction',
            operation: action,
            data: { element, ...data }
        }, `üë§ USER_ACTION: ${action} on ${element}`, ['user', 'interaction', action]);
    }
    /**
     * AIÂàÜÊûêÁî®: ÁèæÂú®„ÅÆ„É≠„Ç∞„Éê„ÉÉ„Éï„Ç°„Çí„ÉÄ„É≥„ÉóÔºà„Éá„Éê„ÉÉ„Ç∞ÊôÇÔºâ
     */
    dump() {
        return [...this.logBuffer];
    }
    /**
     * AIÂàÜÊûêÁî®: ÁâπÂÆö„Çø„Ç∞„ÅÆ„É≠„Ç∞„Éï„Ç£„É´„Çø„É™„É≥„Ç∞
     */
    getLogsByTags(tags) {
        return this.logBuffer.filter(log => tags.some(tag => log.tags.includes(tag)));
    }
    /**
     * AIÂàÜÊûêÁî®: „Ç®„É©„ÉºÈñ¢ÈÄ£„É≠„Ç∞„ÅÆÈõÜÁ¥Ñ
     */
    getErrorContext() {
        return this.logBuffer.filter(log => log.level >= LogLevel.ERROR || log.tags.includes('error'));
    }
    log(level, context, message, tags = [], correlationId) {
        if (level < this.logLevel)
            return;
        const log = {
            level,
            timestamp: Date.now(),
            sessionId: this.sessionId,
            sequence: ++this.sequence,
            context: {
                ...context,
                timestamp: Date.now(),
                stack: level >= LogLevel.ERROR ? new Error().stack : undefined
            },
            message,
            tags: [...tags, LogLevel[level].toLowerCase()],
            correlationId: correlationId || this.correlationStack[this.correlationStack.length - 1]
        };
        this.logBuffer.push(log);
        // Âæ™Áí∞„Éê„ÉÉ„Éï„Ç°Ôºà„É°„É¢„É™Âà∂ÈôêÔºâ
        if (this.logBuffer.length > 1000) {
            this.logBuffer.shift();
        }
        // AIË™≠„Åø„ÇÑ„Åô„ÅÑÊßãÈÄ†ÂåñÂá∫Âäõ
        this.outputStructuredLog(log);
    }
    outputStructuredLog(log) {
        const timestamp = new Date(log.timestamp).toISOString();
        const level = LogLevel[log.level].padEnd(5);
        const component = log.context.component.padEnd(15);
        const method = log.context.method?.padEnd(20) || ''.padEnd(20);
        const correlation = log.correlationId ? ` [${log.correlationId.slice(-8)}]` : '';
        // AIËß£ÊûêÁî®„ÅÆÊßãÈÄ†Âåñ„Éï„Ç©„Éº„Éû„ÉÉ„Éà
        const output = `${timestamp} ${level} ${component} ${method} ${log.message}${correlation}`;
        switch (log.level) {
            case LogLevel.DEBUG:
                console.debug(output, log.context.data ? { data: log.context.data } : '');
                break;
            case LogLevel.INFO:
                console.info(output, log.context.data ? { data: log.context.data } : '');
                break;
            case LogLevel.WARN:
                console.warn(output, log.context.data ? { data: log.context.data } : '');
                break;
            case LogLevel.ERROR:
            case LogLevel.FATAL:
                console.error(output, {
                    data: log.context.data,
                    error: log.context.error?.message,
                    stack: log.context.stack
                });
                break;
        }
    }
    generateSessionId() {
        return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    generateCorrelationId() {
        return `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    sanitizeData(data) {
        if (!data)
            return data;
        // Ê©üÂØÜÊÉÖÂ†±„ÅÆÈô§Âéª
        const sanitized = JSON.parse(JSON.stringify(data));
        if (typeof sanitized === 'object') {
            delete sanitized.password;
            delete sanitized.token;
            delete sanitized.apiKey;
        }
        return sanitized;
    }
    logSystemInfo() {
        this.info({
            component: 'SYSTEM',
            method: 'init',
            operation: 'STARTUP',
            userAgent: navigator.userAgent,
            url: window.location.href,
            data: {
                viewport: `${window.innerWidth}x${window.innerHeight}`,
                language: navigator.language,
                platform: navigator.platform,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine
            }
        }, 'üåü SYSTEM_STARTUP', ['system', 'startup', 'environment']);
    }
}
// AIËß£ÊûêÁî®„ÅÆ„Ç∞„É≠„Éº„Éê„É´„Ç®„ÇØ„Çπ„Éù„Éº„Éà
export const logger = AILogger.getInstance();
//# sourceMappingURL=AILogger.js.map